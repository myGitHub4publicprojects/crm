{% extends "crm/base.html" %}

{% block content %}
<div class="input-group input-group-sm mb-3">
    <div class="input-group-prepend">
      <label class="input-group-text" for="inputGroupSelect01">Sortowanie:</label>
    </div>
    <select class="custom-select" id="inputGroupSelect01">
      <option selected>wybierz...</option>
      <option value="last_name">nazwisko A-Z</option>
      <option value="-last_name">nazwisko Z-A</option>
      <option value="first_name">imię A-Z</option>
      <option value="-first_name">imię Z-A</option>
      <option value="date_of_birth">data ur od najstarszego</option>
      <option value="-date_of_birth">data ur od najmłodszego</option>
      <option value="create_date">data dodania od najstarszego</option>
      <option value="-create_date">data dodania od najmłodszego</option>
      <option value="location">miejscowość A-Z</option>
      <option value="-location">miejscowość Z-A</option>
    </select>
  </div>

{% if patient_list %}
<table class="table">
	<tr>
		<th>Nazwisko</th>
		<th>Imię</th>
        <th>Miejscowość</th>
		<th>Data urodzenia</th>
		<th>Data dodania</th>
	</tr>
	{% for patient in patient_list %}
	<tr>
		<td><a href="{% url 'crm:edit' patient.id %}">{{ patient.last_name }}</a></td>
		<td><a href="{% url 'crm:edit' patient.id %}">{{ patient.first_name }}</a></td>
        <td>{{ patient.location }}</td>
		<td>{{ patient.date_of_birth|date:'Y m d' }}</td>
		<td>{{ patient.create_date|date:'Y m d' }}</td>
	
	</tr>

	{% endfor %}
</table>

{% block pagination %}
    {% if is_paginated %}
        <div class="pagination">
            <span class="page-links">
                {% if page_obj.has_previous %}
                    <a href="{{ request.path }}?{{GET_params.urlencode}}&page={{ page_obj.previous_page_number }}">previous</a>
                {% endif %}
                <span class="page-current">
                    Strona {{ page_obj.number }} z {{ page_obj.paginator.num_pages }}.
                </span>
                {% if page_obj.has_next %}
                    <a href="{{ request.path }}?{{GET_params.urlencode}}&page={{ page_obj.next_page_number }}">next</a>
                {% endif %}
            </span>
        </div>
    {% endif %}
{% endblock %}

{% else %}
	<p>Nie ma takich pacjentów</p>
{% endif %}
</div>
<script>
    document.getElementById('inputGroupSelect01').addEventListener('change', function() {
    window.location.href = "{% url 'crm:index' %}?order_by=" + this.value;
    });
</script>
{% endblock content %}