{% extends "crm/base.html" %}

{% block content %}
<h1>Dodaj nowego pacjenta</h1>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form action="{% url 'crm:store' %}" method="post" id="new_patient">
{% csrf_token %}

<div id='details'>
<div class="patient_info">
	<input type="text" name="fname" placeholder="ImiÄ™" required>
	<input type="text" name="lname" placeholder="Nazwisko" required><br>
	Data ur:<input type="date" name="bday" required><br>
	nr telefonu:<input type="tel" name="usrtel" placeholder="jak nie ma to zero" required><br>
</div>

<div class="hearing_aid">
		{% for ear in ears %}
		<div class={{ ear }}>
		<h4>Obecny aparat {% if ear == "right" %}prawy{% else %}lewy{% endif %}:</h4>
		<ul>
			{% for make, families in ha_list.items %}
			<li onclick="document.getElementById('{{ ear }}_{{ make }}').style.display='block'">{{ make }}</li>

			<ul id={{ ear }}_{{ make }} style="display:none">
				{% for family, models in families.items %}
				<li onclick="document.getElementById('{{ ear }}_{{ make }}_{{ family }}').style.display='block'">{{ family }}
					<ul id={{ ear }}_{{ make }}_{{ family }} style="display:none">
						{% for model in models %}
						<li><input  name="{{ ear }}_ha" type="radio" value={{ make }}_{{ family }}_{{ model }} /><label for={{ make }}_{{ family }}_{{ model }}>{{ model }}</label></li>
						{% endfor %}
					</ul>
				</li>
				{% endfor %}
			</ul>
			{% endfor %}

		</ul>
		Data zakupu:<input type="date" name="{{ ear }}_purchase_date"><br>
		</div>
		{% endfor %}
</div>
<!-- <input class="note" type="text" name="note" placeholder="notatka o paciencie"><br> -->

<textarea form="new_patient" name="note" id="patient_note" placeholder="notatka o pacjencie"></textarea>

Lokalizacja:<br>
{% for location in locations %}
	<input type="radio" name="location" id="location{{ forloop.counter }}" value="{{ location }}" required/>
	<label for="location{{ forloop.counter }}">{{ location }}</label><br/>
{% endfor %}

Pacjent dodany przez: <br>
{% for audiometrist in audiometrist_list %}
	<input type="radio" name="audiometrist" id="audiometrist{{ forloop.counter }}" value="{{ audiometrist }}" required/>
	<label for="audiometrist{{ forloop.counter }}">{{ audiometrist }}</label><br/>
{% endfor %}

</div>

<input type="submit" value="Dodaj" />
</form>

{% endblock content %}